//------------------------------------------------------------------------------
// Note : BASE ADV SYSTEM
// Data : 2008/04/03
// File : Init.tjs - •∑•π•∆•‡§Œ≥ı∆⁄ªØ
// Creator : Kazuyuki Uchino
// Memo : Init File
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
//”… –°¯Bﬂ[ ï‘ –ﬁ∏ƒ
//“∆≥˝¡ÀCFŒƒº˛≈–∂œª˙÷∆∫ÕÕ‚π“XP3Œƒº˛≈–∂œª˙÷∆
//------------------------------------------------------------------------------

//DEBUG Version§´§…§¶§´
@set(_DEBUG = 0)

//ÃÂÚY∞Ê§´§…§¶§´[0:—u∆∑∞Ê 1:ÃÂÚY∞Ê]
@set(_GAMEMODE = 0)




/*-----------------------------------------
°ıSAVE DATA§Œ‘O∂®
-----------------------------------------*/
// SAVEPATH§Œ◊˜≥…
var Savefolder = System.exePath + "savedata/";
/*
// CNF FILE√˚§Œ◊˜≥…
@if(_GAMEMODE == 0)
var CnfName    = "haruno.cf";
@endif
@if(_GAMEMODE == 1)
var CnfName    = "haruno_tr.cf";
@endif

*/

// AutoPath§Œ‘O∂®
Storages.addAutoPath(Savefolder);

// SAVE MODE§Œ‘O∂®
var scSaveMode = "z"; //z:àRøs c:∫Ü“◊∞µ∫≈ªØ

var f            =%[];	//USER SAVE∏Òº{≈‰¡–

var s            =%[];	//SYSTEM SAVE∏Òº{≈‰¡–

//°ˆSAVE DATA ID
// http://kikyou.info/uuidgen/uuidgen.php §«»°µ√
// ÃÂÚY∞Ê 2c26352d-61b7-494f-b252-b20dfd2a5caf
// —u∆∑∞Ê a293c327-5c1a-4767-909e-693bde4d7342

var scSaveDataId = "a293c327-5c1a-4767-909e-693bde4d7342";

//var dm           = Debug.message;//•«•–•√•∞•≥•Û•Ω©`•Î≥ˆ¡¶”√

@if(_DEBUG == 1)
scSaveMode   = "";
scSaveDataId = "";
var debug_f  =%[];	//DEBUG —›≥ˆ÷∏∂®”√
var debug_para;		//DEBUG •—•È•·©`•ø
@endif


//dm(CnfName);


//------------------------------------------------------------------------------
//
// ‘O∂®•’•°•§•Î§Œ≤ª’˝â‰∏¸ªÿ±‹
//		§ƒ§ﬁ§Î§»§≥§Ì•’•°•§•Îœ˜≥˝≥Ã∂»§«•«•–•√•∞•·•À•Â©`§¨≥ˆ§Î§Œ§œ“äø‡§∑§§§Œ§«°£
//
//------------------------------------------------------------------------------
@if(_DEBUG == 0)
/*
var success = 0;

var cnfFileName = System.exePath + CnfName;

if (Storages.isExistentStorage(cnfFileName))
{
	var fileData   = new Array();
	var optionNum  = 4;
	var optionName = ["hkcontroller=\"\"", "hkeditor=\"\"", "hkwatch=\"\"", "hkconsole=\"\""];

	var flags = 0, i, j;

	fileData.load(cnfFileName);

	for (i = j = 0; i < fileData.count;) {

		if (!fileData[i].indexOf( optionName[j] )) {

			if ((flags >> j) & 1) break;

			flags |= (1 << j), j = 0, ++i;

			continue;
		}

		if ((++j) > optionNum) j = 0, ++i;
	}

	if (i == fileData.count) {

		for (i = 0; i < optionNum; ++i) {

			if (((flags >> i) & 1) == 0) break;
		}

		if (i == optionNum) success = 1;
	}

	invalidate fileData;
}

if (!success) {
	System.inform("’˝≥£§À∆Ñ”§«§≠§ﬁ§ª§Û§«§∑§ø");
	System.exit();
}
*/
@endif



/*°Ù•—•π§Œ‘O∂®
	··§À÷∏∂®§∑§øŒÔ§¨°¢§Ë§ÍÉûœ»§µ§Ï§∆ π”√§µ§Ï§Î
	
	•«•–•√•∞”√§Œ∏˜•’•©•Î•¿§»°¢Release”√§Œxp3•’•°•§•Î§Œ•—•π
	‘O∂®°£
*/


//XP3”√•¢©`•´•§•÷‘O∂®Èv ˝
function useArchiveIfExists(name)
{
	// name §¨¥Ê‘⁄§∑§∆§§§ø§È§Ω§Œ•¢©`•´•§•÷§Ú π§¶
	var arcname = "";
	
	if(Storages.isExistentStorage(arcname = System.exePath + name))
	{
		Storages.addAutoPath(arcname + ">");
		
		return true;
	}
	
	return false;
}




//•π•»•Ï©`•∏•—•π§Œ‘O∂®
Storages.addAutoPath(System.exePath + "/");                 // exePath §Œ data
Storages.addAutoPath(System.exePath + "data/");             // exePath §Œ data
Storages.addAutoPath("sys_source/");                        // sys_source •’•©•Î•¿
Storages.addAutoPath("macro/");                             // macro      •’•©•Î•¿
//scenario
Storages.addAutoPath("scenario/");
Storages.addAutoPath("scenario/@_π≤Õ®/");            // @_π≤Õ®     •’•©•Î•¿
Storages.addAutoPath("scenario/A_≤ÀƒÀª®/");          // A_≤ÀƒÀª®   •’•©•Î•¿
Storages.addAutoPath("scenario/B_§≥§Œ§ﬂ/");          // B_§≥§Œ§ﬂ   •’•©•Î•¿
Storages.addAutoPath("scenario/C_ª®¿Ê/");            // C_ª®¿Ê     •’•©•Î•¿
Storages.addAutoPath("scenario/D_”Í“Ù/");            // D_”Í“Ù     •’•©•Î•¿
Storages.addAutoPath("scenario/E_≤ ≤À/");            // E_≤ ≤À     •’•©•Î•¿
Storages.addAutoPath("scenario/Replay/");            // Replay     •’•©•Î•¿
Storages.addAutoPath("scenario/•®•Ø•π•»•È/");        // •®•Ø•π•»•È •’•©•Î•¿
Storages.addAutoPath("scenario/ÃÂÚY∞Ê/");            // ÃÂÚY∞Ê     •’•©•Î•¿
//image00
Storages.addAutoPath("image00/");
Storages.addAutoPath("image00/map/");          // map    •’•©•Î•¿
Storages.addAutoPath("image00/csv/");          // csv    •’•©•Î•¿
//image01
Storages.addAutoPath("image01/");
Storages.addAutoPath("image01/L/");               // bg/l       •’•©•Î•¿
//image02
Storages.addAutoPath("image02/");
Storages.addAutoPath("image02/L/");               // ev/l       •’•©•Î•¿
Storages.addAutoPath("image02/thm/");             // ev/thm     •’•©•Î•¿
//inage02_2
Storages.addAutoPath("image02_2/");
Storages.addAutoPath("image02_2/L/");               // ev/l       •’•©•Î•¿
Storages.addAutoPath("image02_2/thm/");             // ev/thm     •’•©•Î•¿
//image03
Storages.addAutoPath("image03/");
Storages.addAutoPath("image03/trans/");           // trans      •’•©•Î•¿
Storages.addAutoPath("image03/effect/");          // effect     •’•©•Î•¿
Storages.addAutoPath("image03/effect/A/");        // ending     •’•©•Î•¿
Storages.addAutoPath("image03/effect/B/");        // ending     •’•©•Î•¿
Storages.addAutoPath("image03/effect/C/");        // ending     •’•©•Î•¿
Storages.addAutoPath("image03/effect/D/");        // ending     •’•©•Î•¿
Storages.addAutoPath("image03/effect/E/");        // ending     •’•©•Î•¿
Storages.addAutoPath("image03/effect/F/");        // ending     •’•©•Î•¿
//image04
Storages.addAutoPath("image04/");
Storages.addAutoPath("image04/face/");            // •’•ß•§•π•’•©•Î•¿
Storages.addAutoPath("image04/L/");               // bu/l       •’•©•Î•¿
Storages.addAutoPath("image04/M/");               // bu/m       •’•©•Î•¿
Storages.addAutoPath("image04/S/");               // bu/s       •’•©•Î•¿
Storages.addAutoPath("image04/L/¬„/");            // bu/l/¬„    •’•©•Î•¿
Storages.addAutoPath("image04/M/¬„/");            // bu/m/¬„    •’•©•Î•¿
Storages.addAutoPath("image04/S/¬„/");            // bu/s/¬„    •’•©•Î•¿
//image04_2
Storages.addAutoPath("image04_2/");
Storages.addAutoPath("image04_2/face/");            // •’•ß•§•π•’•©•Î•¿
Storages.addAutoPath("image04_2/L/");               // bu/l       •’•©•Î•¿
Storages.addAutoPath("image04_2/M/");               // bu/m       •’•©•Î•¿
Storages.addAutoPath("image04_2/S/");               // bu/s       •’•©•Î•¿
Storages.addAutoPath("image04_2/L/¬„/");            // bu/l/¬„    •’•©•Î•¿
Storages.addAutoPath("image04_2/M/¬„/");            // bu/m/¬„    •’•©•Î•¿
Storages.addAutoPath("image04_2/S/¬„/");            // bu/s/¬„    •’•©•Î•¿
//image05
Storages.addAutoPath("image05/");
Storages.addAutoPath("image05/face/");            // •’•ß•§•π•’•©•Î•¿
Storages.addAutoPath("image05/L/");               // bu/l       •’•©•Î•¿
Storages.addAutoPath("image05/M/");               // bu/m       •’•©•Î•¿
Storages.addAutoPath("image05/S/");               // bu/s       •’•©•Î•¿
Storages.addAutoPath("image05/L/¬„/");            // bu/l/¬„    •’•©•Î•¿
Storages.addAutoPath("image05/M/¬„/");            // bu/m/¬„    •’•©•Î•¿
Storages.addAutoPath("image05/S/¬„/");            // bu/s/¬„    •’•©•Î•¿
//image06
Storages.addAutoPath("image06/");
Storages.addAutoPath("image06/csv/");          // csv    •’•©•Î•¿
//media
Storages.addAutoPath("media/bgm/");             // bgm        •’•©•Î•¿
Storages.addAutoPath("media/se/");              // se         •’•©•Î•¿
//movie
Storages.addAutoPath("movie/");
//voice01
Storages.addAutoPath("voice01/");
//voice02
Storages.addAutoPath("voice02/");
Storages.addAutoPath("voice02/A/");       // voice/a     •’•©•Î•¿
Storages.addAutoPath("voice02/B/");       // voice/b     •’•©•Î•¿
Storages.addAutoPath("voice02/C/");       // voice/c     •’•©•Î•¿
Storages.addAutoPath("voice02/D/");       // voice/d     •’•©•Î•¿
Storages.addAutoPath("voice02/E/");       // voice/e     •’•©•Î•¿
Storages.addAutoPath("voice02/F/");       // voice/f     •’•©•Î•¿
Storages.addAutoPath("voice02/G/");       // voice/g     •’•©•Î•¿
Storages.addAutoPath("voice02/H/");       // voice/h     •’•©•Î•¿
Storages.addAutoPath("voice02/I/");       // voice/i     •’•©•Î•¿
Storages.addAutoPath("voice02/J/");       // voice/J     •’•©•Î•¿
Storages.addAutoPath("voice02/K/");       // voice/k     •’•©•Î•¿
Storages.addAutoPath("voice02/L/");       // voice/l     •’•©•Î•¿
Storages.addAutoPath("voice02/M/");       // voice/m     •’•©•Î•¿
Storages.addAutoPath("voice02/PRE/");     // voice/pre   •’•©•Î•¿
Storages.addAutoPath("voice02/Y/");       // voice/y     •’•©•Î•¿
Storages.addAutoPath("voice02/Z/");       // voice/z     •’•©•Î•¿
//voice02_2
Storages.addAutoPath("voice02_2/");
Storages.addAutoPath("voice02_2/A/");       // voice/a     •’•©•Î•¿
Storages.addAutoPath("voice02_2/B/");       // voice/b     •’•©•Î•¿
Storages.addAutoPath("voice02_2/C/");       // voice/c     •’•©•Î•¿
Storages.addAutoPath("voice02_2/D/");       // voice/d     •’•©•Î•¿
Storages.addAutoPath("voice02_2/E/");       // voice/e     •’•©•Î•¿
Storages.addAutoPath("voice02_2/F/");       // voice/f     •’•©•Î•¿
Storages.addAutoPath("voice02_2/G/");       // voice/g     •’•©•Î•¿
Storages.addAutoPath("voice02_2/H/");       // voice/h     •’•©•Î•¿
Storages.addAutoPath("voice02_2/I/");       // voice/i     •’•©•Î•¿
Storages.addAutoPath("voice02_2/J/");       // voice/J     •’•©•Î•¿
Storages.addAutoPath("voice02_2/K/");       // voice/k     •’•©•Î•¿
Storages.addAutoPath("voice02_2/L/");       // voice/l     •’•©•Î•¿
Storages.addAutoPath("voice02_2/M/");       // voice/m     •’•©•Î•¿
Storages.addAutoPath("voice02_2/PRE/");     // voice/pre   •’•©•Î•¿
Storages.addAutoPath("voice02_2/Y/");       // voice/y     •’•©•Î•¿
Storages.addAutoPath("voice02_2/Z/");       // voice/z     •’•©•Î•¿


//SYSTEM SOURCE§Œ’i§ﬂﬁz§ﬂ

/* °ÙFixNum.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("FixNum.tjs");

/* °ÙUtility.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("Utility.tjs");

// °Ù•Ê©`•∂©`∂®¡x•’•°•§•Î§Œåg––
Scripts.execStorage("userFix.ks");

/* °ÙParser.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("Parser.tjs");

/* °ÙMainWindow.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("MainWindow.tjs");

/* °ÙBaseObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("BaseObject.tjs");

/* °ÙBaseLayer.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("BaseLayer.tjs");

/* °ÙImageObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("ImageObject.tjs");

/* °ÙImageObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("MessObject.tjs");

/* °ÙSoundCtrlObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("SoundCtrlObject.tjs");

/* °ÙSoundObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("SoundObject.tjs");

/* °ÙMovieObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("MovieObject.tjs");

/* °ÙSelectObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("SelectObject.tjs");

/* °ÙLogObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("LogObject.tjs");

/* °ÙConfigObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("ConfigObject.tjs");

/* °ÙCheckDialog.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("CheckDialog.tjs");

/* °ÙSaveLoadObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("SaveLoadObject.tjs");

/* °ÙTitleObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("TitleObject.tjs");

/* °ÙZoomObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("ZoomObject.tjs");

/* °ÙEffectObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("EffectObject.tjs");

//CG MODE§œ’˝“é∞Ê§Œ§ﬂ
//EXTRA MODE§œ’˝“é∞Ê§Œ§ﬂ
if(nGAMEMODE == 0){
/* °ÙCgmodeReplay.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("CgmodeReplay.tjs");
/* °ÙExtraObject.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("ExtraObject.tjs");
}


/* °ÙDefaultMover.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("DefaultMover.tjs");

/* °ÙAnimationObject.tjs */
Scripts.execStorage("AnimationObject.tjs");

/* °ÙAffine.tjs */
Scripts.execStorage("Affine.tjs");

/* °ÙDelayDrawObject.tjs */
Scripts.execStorage("DelayDrawObject.tjs");

/* °ÙLogThumbObject.tjs */
Scripts.execStorage("LogThumbObject.tjs");

/* °ÙEndingObject.tjs */
Scripts.execStorage("EndingObject.tjs");

/* °ÙDayBordObject.tjs */
Scripts.execStorage("DayBordObject.tjs");




//•«•–•√•∞”√ÑI¿Ì
@if(_DEBUG == 1)
Storages.addAutoPath("sys_source/debug/");// debug •’•©•Î•¿
/* °ÙDebugInfo.tjs ’i§ﬂﬁz§ﬂ */
Scripts.execStorage("DebugInfo.tjs");
@endif








// •—•√•¡•¢©`•´•§•÷§Œó À˜§» π”√
// §‚§∑§≥§Ï§È§Œ√˚«∞§Ú≥÷§√§ø•¢©`•´•§•÷§¨åg––ø…ƒ‹•’•°•§•Î§»
// Õ¨§∏àˆÀ˘§À§¢§√§øàˆ∫œ°¢§Ω§Ï§ÚÉûœ»§∑§∆ π§¶
/*
var ArchiveStruct = 
[
	"scenario.xp3",	//0
	"image01.xp3" ,	//1
	"image02.xp3" ,	//2
	"image02_2.xp3",//3
	"image03.xp3" ,	//4
	"image04.xp3" ,	//5
	"image04_2.xp3",//6
	"image05.xp3" ,	//7
	"media.xp3"   ,	//8
	"movie.xp3"   ,	//9
	"voice01.xp3" ,	//10
	"voice02.xp3" ,	//11
	"voice02_2.xp3",//12
	"image00.xp3", 	//13
	"image06.xp3" 	//14
];




for(var i=0; i<ArchiveStruct.count; i++)
{//•¢©`•´•§•÷§Ú’i§ﬂﬁz§‡
	if(useArchiveIfExists(ArchiveStruct[i]))
	{
		switch( i ){
		
		case 0:{//scenario.xp3
			var name = System.exePath + "scenario.xp3>";
			
			
			
		}break;
		
		case 1:{//image01.xp3
			
			var name = System.exePath + "image01.xp3>";
						
		}break;
		
		case 2:{//image02.xp3
			var name = System.exePath + "image02.xp3>";
			
						
		}break;
		
		case 3:{//image02_2.xp3
			var name = System.exePath + "image02_2.xp3>";
			
						
		}break;
		
		case 4:{//image03.xp3
			
			var name = System.exePath + "image03.xp3>";
			
					}break;
		
		case 5:{//image04.xp3
			var name = System.exePath + "image04.xp3>";
			
						
		}break;
		
		case 6:{//image04_2.xp3
			var name = System.exePath + "image04_2.xp3>";
			
						
		}break;
		
		case 7:{//image05.xp3
			var name = System.exePath + "image05.xp3>";
			
	
		}break;
		
		case 8:{//media.xp3
			
			var name = System.exePath + "media.xp3>";
			
						
		}break;
		
		case 9:{//movie.xp3
			var name = System.exePath + "movie.xp3>";
			
		}break;
		
		case 10:{//voice01.xp3
			var name = System.exePath + "voice01.xp3>";
			
		}break;
		
		case 11:{//voice02.xp3
			var name = System.exePath + "voice02.xp3>";
			
			
		}break;
		
		case 12:{//voice02_2.xp3
			var name = System.exePath + "voice02_2.xp3>";
			
			
		}break;
		
		case 13:{//image00.xp3
			var name = System.exePath + "image00.xp3>";
			
			
			
		}break;
		
		case 14:{//image06.xp3
			var name = System.exePath + "image06.xp3>";
			
			
		}break;
		
		}
	}
}

*/

var ApendFlag   = false;	//•¢•⁄•Û•«•Û•…•’•È•∞
var ApendUseFlag= false;	//◊∑º”•’•°•§•Î π”√•’•È•∞
var ExScenarioFlag=[];		//EXTRA SCENARIO π”√•’•È•∞
var ExScenarioNum = 9;		//EXTRA  π”√◊Ó¥Û ˝
for (var i=0; i<ExScenarioNum; i++)ExScenarioFlag[i] = false;

// •¢•⁄•Û•«•Û•…”√•—•√•¡ó À˜
if(nAPENDFLAG){
	//•’•°•§•Î§¨¥Ê‘⁄§π§Î§´£ø
	if(Storages.isExistentStorage(System.exePath + nAPENDFILE)){
		//•—•π§»•’•È•∞§Ú¡¢§∆§Î
		ApendFlag = true;
		Storages.addAutoPath(System.exePath + nAPENDFILE+">");
		Storages.addAutoPath(System.exePath + nAPENDFILE+">L/");
		Storages.addAutoPath(System.exePath + nAPENDFILE+">M/");
		Storages.addAutoPath(System.exePath + nAPENDFILE+">S/");
	}else{
	//¥Ê‘⁄§∑§ §§àˆ∫œ§œ«ﬁ§´§π
		nAPENDFLAG    = false;
		s["ApendUse"] = false;
	}
	
	//•®•Ø•π•»•È•∑• •Í•™§Œ¥_’J
	for (var i=0; i<ExScenarioNum; i++){
		var file = "";
		switch(i){
		case 0:{ file = nEXTRAFILE01; }break;
		case 1:{ file = nEXTRAFILE02; }break;
		case 2:{ file = nEXTRAFILE03; }break;
		case 3:{ file = nEXTRAFILE04; }break;
		case 4:{ file = nEXTRAFILE05; }break;
		case 5:{ file = nEXTRAFILE06; }break;
		case 6:{ file = nEXTRAFILE07; }break;
		case 7:{ file = nEXTRAFILE08; }break;
		case 8:{ file = nEXTRAFILE09; }break;
		}
		//•’•°•§•Î§¨¥Ê‘⁄§π§Î§´£ø
		if(Storages.isExistentStorage(System.exePath + file)){
			ExScenarioFlag[i] = true;
			Storages.addAutoPath(System.exePath + file +">");
			Storages.addAutoPath(System.exePath + file +">ev/");
			Storages.addAutoPath(System.exePath + file +">voice/");
		}
	}
}













// ◊∑º”§Œ•—•√•¡”√•¢©`•´•§•÷§Œó À˜
for(var i = 1; ; i++)
{
	// •—•√•¡”√•¢©`•´•§•÷ patch2.xp3, patch3.xp3 ... §¨§¢§Îàˆ∫œ§œ§Ω§¡§È§Ú
	// Éûœ»§∑§∆’i§ﬂﬁz§‡§Ë§¶§À
	if(Storages.isExistentStorage(System.exePath + "patch" + i + ".xp3")){
		
		Storages.addAutoPath(System.exePath + "patch" + i + ".xp3>");
		
	}else{
		//üo§§àˆ∫œ§œΩK¡À
		break;
	}
}


//*
//	∂˛÷ÿ∆Ñ”§Œ•¡•ß•√•Ø


// åg––ø…ƒ‹•’•°•§•Î§Œ•—•π§Ú•≠©`§À§∑§∆•Ì•√•Ø§Ú––§¶
if(!System.createAppLock(System.exePath.replace(/[^A-Za-z]/g, '_')))
{
	// §π§«§À∆Ñ”§∑§∆§§§Î
	System.inform(System.title + "§œ§π§«§À∆Ñ”§∑§∆§§§ﬁ§π");
	System.exit();
}

//*/


//ª˘±æ•™•÷•∏•ß•Ø•»§Œ◊˜≥…
var MainObj = void;
	MainObj = new MainWindow(nWND_WIDTH, nWND_HEIGHT);
	
//•¶•£•Û•…•¶•µ•§•∫§Œ¥_’J
if((MainObj.width < nMIN_WIDTH) || (MainObj.height < nMIN_HEIGHT)){
	//◊Ó–°•µ•§•∫§«§‚±Ì æ§«§≠§ §´§√§ø§Œ§«°¢èä÷∆•’•Î•π•Ø•Í©`•Û
	MainObj.fullScreen     = 1;
	MainObj.ScreenSizeType = 5;
}

//íàèà•§•Ÿ•Û•»§Ú”–Ñø§À§π§Î
MainObj.SetExEvent();

//JUMP”√§ŒCOPY§œ§∑§ §§
MainObj.PaserObj.ChageFile("startup.soc");



	// „Éë„ÉÉ„ÉÅÁî®„Ç¢„Éº„Ç´„Ç§„Éñ patch2.xp3, patch3.xp3 ... „Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„Åù„Å°„Çâ„Çí
	// ÂÑ™ÂÖà„Åó„Å¶Ë™≠„ÅøËæº„ÇÄ„Çà„ÅÜ„Å´
	if(Storages.isExistentStorage(System.exePath + "patch" + i + ".xp3")){
		
		Storages.addAutoPath(System.exePath + "patch" + i + ".xp3>");
		
	}else{
		//ÁÑ°„ÅÑÂ†¥Âêà„ÅØÁµÇ‰∫Ü
		break;
	}
}


//*
//	‰∫åÈáçËµ∑Âãï„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ


// ÂÆüË°åÂèØËÉΩ„Éï„Ç°„Ç§„É´„ÅÆ„Éë„Çπ„Çí„Ç≠„Éº„Å´„Åó„Å¶„É≠„ÉÉ„ÇØ„ÇíË°å„ÅÜ
if(!System.createAppLock(System.exePath.replace(/[^A-Za-z]/g, '_')))
{
	// „Åô„Åß„Å´Ëµ∑Âãï„Åó„Å¶„ÅÑ„Çã
	System.inform(System.title + "„ÅØ„Åô„Åß„Å´Ëµ∑Âãï„Åó„Å¶„ÅÑ„Åæ„Åô");
	System.exit();
}

//*/


//Âü∫Êú¨„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ‰ΩúÊàê
var MainObj = void;
	MainObj = new MainWindow(nWND_WIDTH, nWND_HEIGHT);
	
//„Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫„ÅÆÁ¢∫Ë™ç
if((MainObj.width < nMIN_WIDTH) || (MainObj.height < nMIN_HEIGHT)){
	//ÊúÄÂ∞è„Çµ„Ç§„Ç∫„Åß„ÇÇË°®Á§∫„Åß„Åç„Å™„Åã„Å£„Åü„ÅÆ„Åß„ÄÅÂº∑Âà∂„Éï„É´„Çπ„ÇØ„É™„Éº„É≥
	MainObj.fullScreen     = 1;
	MainObj.ScreenSizeType = 5;
}

//Êã°Âºµ„Ç§„Éô„É≥„Éà„ÇíÊúâÂäπ„Å´„Åô„Çã
MainObj.SetExEvent();

//JUMPÁî®„ÅÆCOPY„ÅØ„Åó„Å™„ÅÑ
MainObj.PaserObj.ChageFile("startup.soc");


